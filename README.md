# Скрипт создания Google Sheets

> Release Date: 15.09.2020 ver1.5

**Разработчики**
* [Aleksei Goliguzov](https://github.com/MyLibh)  
* [Alex Kristev](https://github.com/kristevalex)  

**Контакты**
* [Telegram](https://t.me/mylibh)

**Содержание**
* [Описание](#s-About)
* [Установка](#s-Install)
* [Требования](#s-Requirements)
* [Настройка](#s-Settings)
* [Запуск](#s-Launch)

## <a name="s-About"></a> Описание
Скрипт предназначен для создания Google Sheets ограниченного доступа к одной таблице с общими данными.
Итоговым результатом для каждого элемента таблицы(ученика) будет таблица,
содержащая [шапку](#s-Requirements-Header) и [строку ученика](#s-Requirements-Student-Line).
Обрабатываются все листы таблицы(классы), поддерживается деление класса на две группы, подробнее в и [требованиях](#s-Requirements).

## <a name="s-Install"></a> Установка
* _**Шаг 0.**_ Скачайте файл скрипта ([link](src/Create-and-share-sheets-to-pupils.gs)) и сайдбара([link](src/sidebar.html))
* _**Шаг 1.**_ Откройте таблицу и нажмите *"Инструменты"*
	![install-step1](res/Install/Step1.png)
* _**Шаг 2.**_ Выберите *"Редактор скриптов"*
	![install-step2](res/Install/Step2.png)
* _**Шаг 3.**_ Переместите файл со скриптом на форму
	![install-step3](res/Install/Step3.png)
* _**Шаг 4.**_ Сохраните, нажав *кнопку* или *"Ctrl+S"*
	![install-step4](res/Install/Step4.png)
* _**Шаг 5.**_ Придумайте название проекта(например, *"Script"*)
	![install-step5](res/Install/Step5.png)
* _**Шаг 6.**_ Нажмите *"ОК"*:
	![install-step6](res/Install/Step6.png)
* _**Шаг 7.**_ Нажмите *"Файл->Создать->HTML-file"*
	![install-step7](res/Install/Step7.png)
* _**Шаг 8.**_ Назовите *"sidebar"* и нажмите *"ОК"*
	![install-step8](res/Install/Step8.png)
* _**Шаг 9.**_ Переместите файл с сайдбаром на форму (как в *шаге 3*)
	![install-step9](res/Install/Step9.png)
* _**Шаг 10.**_ Сохраните, нажав *кнопку* или *"Ctrl+S"*
	![install-step10](res/Install/Step10.png)
* _**Шаг 12.**_ Вернитесь к таблице и обновите страницу. После обновления(~15-30сек) появится кнопка *Script*
	![install-step11](res/Install/Step11.png)

## <a name="s-Requirements"></a> Требования
* **Формат группы**
	* Название таблицы ученика будет совпадать с его ФИО(ником), а название папки, в которой она будет находиться, - с названием листа.
	* Каждая группа состоит из шапки и строк учеников:
		<a name="s-Requirements-Header"></a>
		* *Шапка* - это несколько подряд идущих строк таблицы, содержащие общую информацию для группы.		  
			* *Размер шапки* - количество строк в ней.
			* *Начало шапки* - номер ее первой строки.

		**Важно!** Во втором столбце шапки все ячейки должны быть отдельны, то есть их нельзя объединять.

		* <a name="s-Requirements-Student-Line"></a>
		  *Строка ученика* - это строка таблицы, содержащая индивидуальную для ученика информацию(например, оценки).
		  Первый столбец таблицы должен содержать электронную почту учеников, второй - их ФИО(ники).
* **Дополнительно для двух групп**
	Начало 2-ой шапки для всех листов(классов), в которых две группы, должно быть одинаковым.
	В листах(классах) с одной группой, если такие есть, она должна заканчивться раньше, чем начало второй шапки в остальных листах.
* **Общие замечания**
	Размер шапок для всех групп(в том числе и в разных классах) должен быть одинаков.
	Начало 1-ой шапки 1-ой группы должно быть на строке 1.

## <a name="s-Settings"></a> Настройка
### __Задачи__
1. [Создать (первый запуск)](#s-Target-1)
2. [Обновить](#s-Target-2)
3. [Обновить формат](#s-Target-3)
4. [Выдать доступ новым email-ам](#s-Target-4)

### Параметры
* **Название папки со студентами** - название папки, в которой будут папки классов.
* **Название листа с оценками** - название листа, в котором будут оценки студента.
* **Добавок к папке студента** 
* **Количество строк в шапке** - смотреть [сюда](#s-Requirements-Header).
* (опц.) **Вторая группа** - строка, с которой начинается вторая шапка.
* (опц.) **Листы для копирования** - выбрать листы, которые будут скопированы к студенту. Чтобы выбрать несколько - __Ctrl тык-тык__

### <a name="s-Target-1"></a> Создать таблички
Используется для первого создания всей иерархии:
```
marks.gsheet
main_folder/
├── class1/
|   ├── student1/
|   |   └── student_marks.gsheet
|   ├── ...
|   └── studentN/
├── ...
└── classN/
```

### <a name="s-Target-2"></a> Обновить
Работает аналогично [Create students sheets](#s-Target-1), за тем исключением, что создает все только для студентов, у которых нет папки.
Если папка создана, но положение студента в ведомости изменилось, обновляет импортирующую формулу.

### <a name="s-Target-3"></a> Обновить формат
Обновляет форматирование и/или добавляет остутствующие листы для созданных студентов.

### <a name="s-Target-4"></a> Выдать доступ новым email-ам
Выдает доступ на просмотр для новых email-ов, повторно доступ не выдается.
В случае отсутствия студента(папки нет) создает его пустую папку и больше ничего не делает.

## <a name="s-Launch"></a> Запуск
* _**Шаг 1.**_ Нажимаете *Script->Sidebar*
	![launch-step1](res/Launch/Step1.png)
* _**Шаг 2.**_ Разрешите доступ скрипту (в первый раз)
* _**Шаг 3.**_ Справа появится сайдбар с настройками
	![launch-step3](res/Launch/Step3.png)
* _**Шаг 4.**_ Поочередно открывайте созданные файлы и разрешайте доступ, нажав на *"Открыть доступ"*
![launch-step3](res/Launch/Step4.png)